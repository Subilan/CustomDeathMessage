# 关于死亡信息

## 死亡原因划分

死亡原因根据 [API 中所给出的死亡原因](https://hub.spigotmc.org/javadocs/spigot/org/bukkit/event/entity/EntityDamageEvent.DamageCause.html)（确切来说是死前最后一次被伤害的原因），划分为了全局死亡原因和实体或方块致死原因两种。

全局死亡原因是直接从 DamageCause 中照搬的，代表一个特定的死亡原因，例如溺亡、焚亡、窒息而亡；实体或方块致死原因则是指由实体或方块所引起的死亡，代表一个由特定对象引起的死亡，例如被 TNT 炸死，被苦力怕炸死，被僵尸打死。它们每一项具体的意思在 `message.yml` 中已经写得比较清楚了。

由于 DamageCause 中原先是存在 `ENTITY_ATTACK`、`BLOCK_EXPLOSION`、`ENTITY_EXPLOSION`（分别为实体攻击、方块爆炸、实体爆炸）等元素的，但由于我们独立划分出了一个「实体或方块致死」的原因，相当于是把它们细化了，所以这些全局死亡原因都会失效。也正因此，`message.yml` 中没有列出这些原因。

## 关于弓箭

判定玩家死亡原因的关键就是知道玩家在死之前最后一次被伤害的原因。例如，如果最后一次被伤害是因为摔倒（`FALL`），那么就代表玩家是摔死的，以此类推。

但对于弓箭这类攻击用具，由于弓箭也属于实体，所以当玩家被生物射箭杀死的时候，实际上**就是被「弓箭」杀死了**。这有点不好理解，但的确，玩家死前最后一次受到的伤害来自于弓箭。

这个时候，我们简化了这个流程。正常情况下，当你填 `SKELETON`（骷髅射手）想要写有关于它的死亡信息时，你会发现这个信息并不会出现；但当你填 `ARROW`（箭）的时候，却发现无论是什么生物（包括玩家）射死玩家，都只会提示这个消息。

经过简化后，玩家被弓箭杀死将会链接到多个生物。如果是被骷髅射死的，那么将链接到 `SKELETON` 而不是 `ARROW`；如果是被幻术师用箭射死的，那么将链接到 `ILLUSIONER_ARROW` 而不是 `ARROW`。如果幻术师没有用箭而杀死了玩家，则自动回退到 `ILLUSIONER` 项，以此类推。对于那些只会用箭的，例如骷髅射手，则不会有 `ARROW` 后缀。

按照群友的描述，Minecraft 中能够射箭杀人的只有玩家（`PLAYER`）、骷髅射手（`SKELETON`）、幻术师（`ILLUSIONER`）、猪灵（`PIGLIN`）、卫道士（`VINDICATOR`）、流浪者（`STRAY`）。如果有任何异议，欢迎在 Issue 中提出或者发送 Pull Request 协助改进。

## 关于特殊的死亡信息

Minecraft 中确实有很多特殊的死亡信息，这些死亡信息又往往由不同条件触发。根据 Minecraft Wiki 所述，单就摔死就有根据高度而变换的数种死亡信息变种。除了这些根据玩家死亡时的各种环境因素而变化的信息，还有一些特殊的触发机制，例如在地狱、末地中被床炸死。

若要改变这些特殊的死亡信息，则必须通过代码来模拟玩家死亡的整个过程和触发机制。一些比较简单的，例如「刻意的游戏设计」，只是因为在地狱或末地中被床炸死，而又因为在主世界中床并不会爆炸，所以只需要判断玩家是不是被床炸死的即可。

这些特殊的死亡信息都会被放在 `special` 下面供设置，它们往往优先级最高。
